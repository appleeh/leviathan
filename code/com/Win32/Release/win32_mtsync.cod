; Listing generated by Microsoft (R) Optimizing Compiler Version 19.00.24215.1 

	TITLE	E:\InfiniA-Library-3.0\com\include\com\win32\win32_mtsync.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_initSpinLock@4
PUBLIC	_acquireSpinLock@4
PUBLIC	_releaseSpinLock@4
EXTRN	__imp__InterlockedCompareExchange@12:PROC
; Function compile flags: /Ogtp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
;	COMDAT _releaseSpinLock@4
_TEXT	SEGMENT
_pLock$ = 8						; size = 4
_releaseSpinLock@4 PROC					; COMDAT

; 20   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h

; 94   : 	inline void init() { m_count = 0; }

  00003	8b 45 08	 mov	 eax, DWORD PTR _pLock$[ebp]
  00006	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], 0
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp

; 22   : }

  0000c	5d		 pop	 ebp
  0000d	c2 04 00	 ret	 4
_releaseSpinLock@4 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
;	COMDAT _acquireSpinLock@4
_TEXT	SEGMENT
_pLock$ = 8						; size = 4
_acquireSpinLock@4 PROC					; COMDAT

; 9    : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h

; 99   : 	inline int atomic_compare_exchange(int nExchange, int nComperand) {return (int)InterlockedCompareExchange(&m_count, nExchange, nComperand);} // return long

  00004	8b 75 08	 mov	 esi, DWORD PTR _pLock$[ebp]
  00007	57		 push	 edi
  00008	8b 3d 00 00 00
	00		 mov	 edi, DWORD PTR __imp__InterlockedCompareExchange@12
  0000e	6a 00		 push	 0
  00010	6a 01		 push	 1
  00012	56		 push	 esi
  00013	ff d7		 call	 edi
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp

; 12   : 	if(!pLock->atomic_compare_exchange(1,0)) return;

  00015	85 c0		 test	 eax, eax
  00017	74 1e		 je	 SHORT $LN11@acquireSpi
  00019	0f 1f 80 00 00
	00 00		 npad	 7
$loop$19:

; 13   : 			
; 14   : 	n = 1024;
; 15   : 	while(n--) YieldProcessor();

  00020	b8 00 04 00 00	 mov	 eax, 1024		; 00000400H
$LL2@acquireSpi:
  00025	83 e8 01	 sub	 eax, 1
  00028	f3 90		 pause
  0002a	75 f9		 jne	 SHORT $LL2@acquireSpi
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h

; 99   : 	inline int atomic_compare_exchange(int nExchange, int nComperand) {return (int)InterlockedCompareExchange(&m_count, nExchange, nComperand);} // return long

  0002c	6a 00		 push	 0
  0002e	6a 01		 push	 1
  00030	56		 push	 esi
  00031	ff d7		 call	 edi
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp

; 12   : 	if(!pLock->atomic_compare_exchange(1,0)) return;

  00033	85 c0		 test	 eax, eax
  00035	75 e9		 jne	 SHORT $loop$19
$LN11@acquireSpi:
  00037	5f		 pop	 edi
  00038	5e		 pop	 esi

; 16   : 	goto loop;
; 17   : }

  00039	5d		 pop	 ebp
  0003a	c2 04 00	 ret	 4
_acquireSpinLock@4 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp
;	COMDAT _initSpinLock@4
_TEXT	SEGMENT
_pLock$ = 8						; size = 4
_initSpinLock@4 PROC					; COMDAT

; 4    : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h

; 94   : 	inline void init() { m_count = 0; }

  00003	8b 45 08	 mov	 eax, DWORD PTR _pLock$[ebp]
  00006	c7 00 00 00 00
	00		 mov	 DWORD PTR [eax], 0
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.cpp

; 6    : }

  0000c	5d		 pop	 ebp
  0000d	c2 04 00	 ret	 4
_initSpinLock@4 ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h
;	COMDAT ?atomic_compare_exchange@win_atomic@win32@common@@QAEHHH@Z
_TEXT	SEGMENT
_nExchange$ = 8						; size = 4
_nComperand$ = 12					; size = 4
?atomic_compare_exchange@win_atomic@win32@common@@QAEHHH@Z PROC ; common::win32::win_atomic::atomic_compare_exchange, COMDAT
; _this$ = ecx

; 99   : 	inline int atomic_compare_exchange(int nExchange, int nComperand) {return (int)InterlockedCompareExchange(&m_count, nExchange, nComperand);} // return long

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	ff 75 0c	 push	 DWORD PTR _nComperand$[ebp]
  00006	ff 75 08	 push	 DWORD PTR _nExchange$[ebp]
  00009	51		 push	 ecx
  0000a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__InterlockedCompareExchange@12
  00010	5d		 pop	 ebp
  00011	c2 08 00	 ret	 8
?atomic_compare_exchange@win_atomic@win32@common@@QAEHHH@Z ENDP ; common::win32::win_atomic::atomic_compare_exchange
_TEXT	ENDS
; Function compile flags: /Ogtp
; File e:\infinia-library-3.0\com\include\com\win32\win32_mtsync.h
;	COMDAT ?init@win_atomic@win32@common@@QAEXXZ
_TEXT	SEGMENT
?init@win_atomic@win32@common@@QAEXXZ PROC		; common::win32::win_atomic::init, COMDAT
; _this$ = ecx

; 94   : 	inline void init() { m_count = 0; }

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], 0
  00006	c3		 ret	 0
?init@win_atomic@win32@common@@QAEXXZ ENDP		; common::win32::win_atomic::init
_TEXT	ENDS
END
